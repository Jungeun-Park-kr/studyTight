<!DOCTYPE html>
<html lang="ko">

<head >
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StudyTight</title>
    <script src="/user/users.js"></script>
    <script src="/login/login.js"></script>
    <script src="/menu.js"></script>
    <script src="/mainframe.js"></script>
    <script src="/mainframe_shortcuts.js"></script>
    <script src="/mainframe_profile.js"></script>
    <style>
        @import url(mainframe.css);
        @import url(mainframe_shortcuts.css);
    </style>
    </script>
</head>
<body>
    <div id="wrap">
        <div class="page-menu">
            <!-- 여기는 왼쪽 메뉴 (로고, 메뉴버튼들) -->
            <div class="logo_area">
                <img src="/media/logo.png" class=logo onclick="btnHomeInHome();">
            </div>
            <ul class="left-menus">
                <li class="menu_home" onclick="btnHomeInHome();">
                    <img src="media/home.png">&nbsp내 공부방</img>
                </li>
                <li class="menu_contact" onclick="btnContact();">
                    <img src="media/contact-book.png">&nbsp방명록</img>
                </li>
                <li class="menu_timetable" onclick="btnTimetable();">
                    <img src="media/timetable.png">&nbsp시간표</img>
                </li>
                <li class="menu_dday" onclick="btnDday();">
                    <img src="media/d-day.png">&nbsp디데이</img>
                </li>
            </ul>
        </div>
        <div class="page-header" role="banner" class>

            <!-- 여기는 상단에 들어갈 헤더 섹션 -->
            <div class="shortcuts_wrap">
                <div id="shortcuts_title">현재 시간표에 등록된 일정이 없습니다</div>
                <div id="shortcuts_link" onclick="openLink();">바로가기</div>
                <!-- <input id="btn_shortcuts_link" type="button" title="바로가기" value="바로가기"> -->
            </div>
        </div>
        <script>
            var isopen = false;
            var isonline = false;
            var course, link;
            var username = localStorage.getItem('username'); //현재 로그인된 사용자 이름 가져오기
            activeUser = getActiveUser(username);  //사용자 이름으로 activeUser의 정보 가져와서 프로필 상태로 띄워줌
            var courselist = activeUser.course;
            for(var i=0; i<courselist.length; i++) {
                course = getRealtimeCourse(courselist[i]); //courselist에서 실시간 강의 찾기
                console.log('리턴:'+course);
                if (course != null) { //30분이내 실시간 강의 있는 경우
                    isopen = true;
                    if (courselist[i].type !== 'offline') { //온라인일 경우 링크 넣기
                        console.log('온라인임:'+courselist[i].location);
                        isonline = true;
                        link = courselist[i].location;
                    }
                    break;
                }
            }
            // 실시간 일정 있는 경우
            if (isopen) {
                console.log('실시간O : '+course);
                doc.getElementById("shortcuts_title").innerHTML = course;
                doc.getElementById("shortcuts_link").style.color = "blue";
            }            
            function openLink() { //바로가기 버튼 누른경우
                if (isopen) { //실시간 수업 있는경우 링크로 이동
                    var win = window.open(link, '_blank');
                    win.focus();
                } else {
                    if (isonline) {
                        alert('현재 등록된 강의 링크가 없습니다.');
                    }
                    else {
                        alert('현재 시간표에 등록된 일정이 없습니다');
                    }
                }
            }
        </script>

        <div class="section">
            <!-- 여기는 본문 들어갈 메인 섹션 -->
            <div class="D-day" id="D-day">
                <!-- 디데이 설정한 부분 -->
                <!-- <div class="d-day" id="d-day1"><span class="d-date" id="d-date1"></span></div>
                <div class="d-day" id="d-day2"><span class="d-date" id="d-date2"></span></div>
                <div class="d-day" id="d-day3"><span class="d-date" id="d-date3" ></span></div>
                <div class="d-day" id="d-day4"><span class="d-date" id="d-date4" ></span></div>
                <div class="d-day" id="d-day5"><span class="d-date" id="d-date5" ></span></div>
                <div class="d-day" id="d-day6"><span class="d-date" id="d-date6" ></span></div> -->
                <script>
                    var username=localStorage.getItem('username');
                    activeUser=getActiveUser(username);

                    var parentDiv=document.getElementById("D-day")

                    var d_daylist=activeUser.d_day;
                    for(var i=0; i<d_daylist.length; i++){
                        var show_day=document.createElement("div");
                        var show_content=document.createElement("span");
                            show_day.setAttribute("class","d-day")
                            show_content.setAttribute("class","d-date")
                            var tmp=d_daylist[i]; //해당 나온 날짜와 내용을 tmp에 넣음
                            //console.log(tmp.day,tmp.content);
                            show_day.innerHTML="D-"+tmp.day
                            show_content.innerHTML=tmp.content
                            //console.log(show_day.innerHTML,show_content.innerHTML)
                            show_day.appendChild(show_content)
                            parentDiv.appendChild(show_day)
                            show_day.style.fontWeight="bold"
                            show_content.style.color="black"
                            if(tmp.day<'4'){
                                show_day.style.color="red"
                            
                            }
                            else if(tmp.day<'8'){
                                show_day.style.color="blue"
                            }
                            else {
                                show_day.style.color="black"
                            }
                        }
                </script>
            </div>

            <div class="folder_">
                <div id="folder_plus" onclick="newFolder()" ;>
                    <p><strong>+</strong>폴더 추가하기</p>
                </div>
                <div id="wrap_folder" class="wrap_folder">

                <!-- <div id="folder_1" class="folder">
                    <img src="media/empty_star.png" class="star" onclick="starClicked(0)" />
                    <p onclick="location.href='/folder/folder.html'"></p>
                </div> -->
                <!-- 영상 찍을 때를 위해서 이 위의 폴더만 클릭하고 새로운 폴더 만들기 --> 
                <!-- <div id="folder_2" class="folder">
                    <img src="media/empty_star.png" class="star" onclick="starClicked(1)" />
                    <p onclick="location.href='/folder/folder.html'"></p>
                </div>
                <div id="folder_3" class="folder">
                    <img src="media/empty_star.png" class="star"  onclick="starClicked(2)" />
                    <p onclick="location.href='/folder/folder.html'"></p>
                </div>
                <div id="folder_4" class="folder">
                    <img src="media/empty_star.png" class="star"  onclick="starClicked(3)" />
                    <p onclick="location.href='/folder/folder.html'"></p>
                </div> -->
                <script>    
            var username=localStorage.getItem('username');
            activeUser=getActiveUser(username);
            var folder_list=activeUser.folder;

            var wrap=document.getElementById("wrap_folder")

            for(var i=0;i<folder_list.length;i++){
                var ran_color=Math.random();
                
                var tmp=folder_list[i]
                var new_div=document.createElement("div")
                new_div.setAttribute("class","folder")
                var new_star=document.createElement("img")
                new_star.setAttribute("class","folder_star")
                new_star.setAttribute("onclick","starClicked("+i+")")
                var new_p=document.createElement("p");
                new_p.setAttribute("class","folder_course")
                
                new_p.innerHTML=tmp.title

                new_p.setAttribute("onclick","toNextPage("+i+")")

                //console.log(tmp.title)
                if(tmp.star=="true"){
                    new_star.src="media/full_star.png"
                }
                else{
                    new_star.src="media/empty_star.png"
                }
                var random=Math.floor(ran_color*3);
                if(random==0){
                    new_div.style.backgroundColor="#E36363"
                }
                else if(random==1){
                    new_div.style.backgroundColor="#E3B863"
                }
                else{
                    new_div.style.backgroundColor="#6ED4D8"
                }


                new_div.appendChild(new_star)
                new_div.appendChild(new_p)
                wrap.appendChild(new_div)
                    //랜덤함수로 folder마다 색을 달리 함
            }


                </script>
            </div>
        </div>
        </div>

        <div class="aside">
            <!-- 여기는 aisde(우측 로그인, 오늘할일) -->
            <div class="aside_wrap">
                <div class="login">
                    <div class="login_white_box">
                        <div class="profile_section">
                            <div class="logout">
                                <input type="button" class="btn_logout" title="로그아웃" value="로그아웃" onclick="logout();" />
                            </div>
                            <div class="profile">
                                <!-- 이미지 클릭시 프로필 관리 화면으로 가는것도 좋을듯 -->
                                <img id="activeUserimg" src="/media/user.png" onclick="location.href='#프로필수정화면'">
                                <div class="username" id="activeUsername">박혁거세님</div>
                                <script>
                                    var username = localStorage.getItem('username'); //현재 로그인된 사용자 이름 가져오기
                                    activeUser = getActiveUser(username);  //사용자 이름으로 activeUser의 정보 가져와서 프로필 상태로 띄워줌
                                    // doc.getElementById('activeUsername').innerHTML = username + '님';
                                    doc.getElementById('activeUsername').innerHTML = activeUser.name + '님';
                                    doc.getElementById('activeUserimg').src = activeUser.userImage;
                                </script>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="today">
                    <p>오늘 할 일</p>
                    <div class="todaylist" id="todaylist">
                        <label><input type="checkbox"><p>웹프로그래밍 수업 듣기</p></label>
                        <label><input type="checkbox"><p>DB 강의 듣기</p></label>
                        <label><input type="checkbox"><p>채플 듣기</p></label>
                        <label><input type="checkbox"><p>OS 보고서 쓰기</p></label> 
                        <script>
                                //여기 안에 오늘 날짜를 조작해서 다음날로 이동하면
                                // var parent=document.getElementById("Todolist");
                                // parent.removechild()함수 사용하면 된다!
                            </script>
                    </div>
                    <input type="button" class="btnplusTodo" value="+ 할 일 추가하기" onclick="plusTodo()"></input>
                    <!--+부분 이미지로 넣기-->
                </div>
                <div class="caution">
                    <pre>
                        오늘(11:59 PM)기준으로 완료된 할 일은
                        내일(12:00 AM)기준으로 제거되고, 
                        완료되지 않은 할 일은 유지됩니다.
                    </pre>
                </div>
            </div>
        </div>
    </div>
    <script>
        console.log("현재화면:메인화면, 사용자:"+ activeUser.name);
    </script>
</body>

</html>